jQuery(document).ready(function(f){var e=f(this),d=f("body");var h={sortable:{axis:"y",start:function(k,l){l.placeholder.height(l.item.height())},stop:function(k,l){l.item.parent().kcReorder(l.item.data("mode"),true)}},colorpicker:{onBeforeShow:function(){f(this).ColorPickerSetColor(this.value)},onSubmit:function(k,o,m,n){var l="#"+o;f(n).css({backgroundColor:l,color:invertColor(l)}).val(l).ColorPickerHide()}},datepicker:{date:{dateFormat:"yy-mm-dd",changeMonth:true,changeYear:true,showButtonPanel:true},month:{changeMonth:true,changeYear:true,dateFormat:"yy-mm",beforeShow:function(l,k){k.dpDiv.addClass("kcDPMonth")},onChangeMonthYear:function(k,m,l){f(this).val(f.datepicker.formatDate("yy-mm",new Date(k,m-1,1)))},onClose:function(l,k){setTimeout(function(){k.dpDiv.removeClass("kcDPMonth")},300)}}}};f("#kc-settings-form").kcMetaboxDeps();f.kcRowCloner();f.kcRowCloner.addCallback("add",function(k){f("ul.kc-rows").sortable("refresh");f(".hasDatepicker",k.nuItem).each(function(){f(this).removeData("datepicker").removeClass("hasDatepicker").datepicker(h.datepicker[f(this).attr("type")])});f(".hasColorpicker",k.nuItem).each(function(){f(this).removeData("colorpickerId").removeAttr("style").ColorPicker(h.colorpicker)})});f("ul.kc-rows").sortable(h.sortable);f(".kcs-tabs").kcTabs();var b=f("input[type=date], input[type=month]");if(b.length&&Modernizr.inputtypes.date===false){var g=f("body").is(".admin-color-classic")?"cupertino":"flick";Modernizr.load([{load:win.kcSettings.paths.styles+"/jquery-ui/"+g+"/style.css",complete:function(){b.each(function(){f(this).datepicker(h.datepicker[f(this).attr("type")])})}}])}var j=f("input[type=color]");if(j.length&&Modernizr.inputtypes.color===false){Modernizr.load([{load:[win.kcSettings.paths.scripts+"/colorpicker/js/colorpicker.js",win.kcSettings.paths.scripts+"/colorpicker/css/colorpicker.css",win.kcSettings.paths.scripts+"/rgbcolor.js"],complete:function(){j.ColorPicker(h.colorpicker).each(function(){var k=f(this).addClass("hasColorpicker");if(k.val()!==""){k.css({backgroundColor:this.value,color:invertColor(this.value)})}})}}])}var a=f("select.chosen");if(a.length){Modernizr.load([{load:[win.kcSettings.paths.scripts+"/chosen.jquery.js",win.kcSettings.paths.styles+"/chosen/chosen.css"],complete:function(){a.each(function(){var k=f(this);k.children('option[value=""]').remove();if(k.prop("multiple")){k.css("width","100%")}k.chosen({allow_single_deselect:!k.prop("required")})})}}])}var i=f("#addtag");if(i.length){var c=f();f("div.kcs-field").each(function(){c=c.add(f(this).clone())});if(c.length){i.ajaxComplete(function(l,m,k){if(k.data.indexOf("action=add-tag")<0){return}f("div.kcs-field").each(function(n){f(this).replaceWith(c.eq(n).clone())});f(".kcs-tabs",i).kcTabs();i.trigger("kcsRefreshed")})}}});